<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¾®å…‰è¨ˆç•«ï¼šå¾©æ­¸æ—…ç¨‹ (v2.0 å¹³è¡¡ç‰ˆ)</title>
    <style>
        :root {
            --bg-color: #1a1a1d;
            --panel-color: #2b2b2e;
            --text-color: #e0e0e0;
            --accent-color: #4ecca3;
            --danger-color: #e23e57;
            --warning-color: #fce38a;
            --info-color: #3498db;
            --muted-color: #95a5a6;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            height: 100dvh;
            overflow: hidden;
        }

        .game-container {
            display: grid;
            grid-template-columns: 260px 1fr 300px;
            gap: 20px;
            width: 95%;
            max-width: 1400px;
            height: 92vh;
            background-color: #000;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        /* å·¦å´ï¼šæ•¸å€¼é¢æ¿ (é€šç”¨åŸºç¤æ¨£å¼) */
        .stats-panel {
            background-color: var(--panel-color);
            padding: 20px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            /* Desktop é è¨­ç›´å‘ */
            gap: 15px;
            overflow-y: auto;
        }

        .stats-left {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            border-bottom: 1px solid #444;
            padding-bottom: 15px;
            margin-bottom: 5px;
        }

        .turn-label {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .avatar {
            font-size: 3rem;
            margin: 10px 0;
            animation: float 3s ease-in-out infinite;
        }

        .stats-right {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }

        .stat-row {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stat-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
        }

        .stat-name {
            color: #ddd;
        }

        .stat-val {
            font-weight: bold;
        }

        .progress-bg {
            width: 100%;
            height: 10px;
            background-color: #444;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            transition: width 0.5s ease;
        }

        .money-val {
            color: var(--warning-color);
            font-size: 1.2rem;
            text-align: right;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        /* ä¸­é–“ï¼šä¸»æ§å° */
        .main-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        .log-area {
            flex: 1;
            background-color: var(--panel-color);
            border-radius: 8px;
            padding: 15px;
            overflow-y: auto;
            font-size: 0.95rem;
            line-height: 1.5;
            scroll-behavior: smooth;
            border-left: 4px solid var(--accent-color);
        }

        .log-entry {
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .log-entry.event {
            color: var(--warning-color);
            border-left: 3px solid var(--warning-color);
            padding-left: 10px;
            background: rgba(252, 227, 138, 0.05);
        }

        .log-entry.danger {
            color: var(--danger-color);
            font-weight: bold;
        }

        .log-entry.success {
            color: var(--accent-color);
        }

        .log-entry.system {
            color: var(--muted-color);
            font-size: 0.85rem;
            text-align: center;
            border-bottom: none;
            margin-top: 20px;
            font-style: italic;
        }

        .log-tip {
            font-size: 0.8rem;
            color: #bbb;
            margin-top: 4px;
            display: block;
            background: rgba(0, 0, 0, 0.2);
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* AP é¡¯ç¤ºå€ */
        .ap-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 5px;
        }

        .ap-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: #333;
            border: 2px solid #555;
            transition: all 0.3s;
        }

        .ap-dot.active {
            background-color: var(--warning-color);
            border-color: #f1c40f;
            box-shadow: 0 0 10px var(--warning-color);
        }

        .action-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            height: auto;
            flex-shrink: 0;
        }

        button {
            background-color: #333;
            border: 1px solid #555;
            color: white;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        button:hover:not(:disabled) {
            background-color: #444;
            transform: translateY(-2px);
            border-color: var(--accent-color);
        }

        button:active:not(:disabled) {
            transform: scale(0.98);
        }

        button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            filter: grayscale(1);
        }

        button strong {
            display: block;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        button .sub {
            font-size: 0.75rem;
            color: var(--muted-color);
        }



        /* å³å´ï¼šç‹€æ…‹åˆ—è¡¨ */
        .status-panel {
            background-color: var(--panel-color);
            padding: 15px;
            border-radius: 8px;
            overflow-y: auto;
        }

        .status-header {
            font-weight: bold;
            padding-bottom: 10px;
            border-bottom: 1px solid #555;
            margin-bottom: 10px;
            color: var(--info-color);
        }

        .status-item {
            background: #222;
            margin-bottom: 8px;
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid #555;
            cursor: pointer;
            transition: background 0.2s;
        }

        .status-item:hover {
            background: #2a2a2a;
        }

        .status-item.debuff {
            border-color: var(--danger-color);
        }

        .status-item.buff {
            border-color: var(--accent-color);
        }

        .status-item.neutral {
            border-color: var(--info-color);
        }

        .status-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-name {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .status-dur {
            font-size: 0.75rem;
            background: #444;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .status-desc {
            display: none;
            font-size: 0.8rem;
            color: #ccc;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed #444;
            line-height: 1.4;
        }

        .status-item.expanded .status-desc {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* RWD */
        /* RWD: ç§»å‹•ç«¯é©é… */
        /* RWD: ç§»å‹•ç«¯é©é… (App Mode) */
        /* RWD: ç§»å‹•ç«¯é©é… (App Mode) - ä»¿ç…§åœ–ç‰‡æ¨£å¼ */
        @media (max-width: 900px) {
            body {
                overflow: hidden;
                height: 100dvh;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .game-container {
                display: flex;
                flex-direction: column;
                width: 100%;
                height: 100%;
                max-width: 100%;
                border-radius: 0;
                box-shadow: none;
                padding: 10px;
                gap: 15px;
                /* å¢åŠ é–“è·è®“ç•«é¢å¹³è¡¡ */
                overflow: hidden;
            }

            /* 1. é ‚éƒ¨ï¼šæ•¸å€¼æ¬„ (åœ–ç‰‡æ¨£å¼) */
            .stats-panel {
                flex-shrink: 0;
                flex-direction: row;
                /* æ©«å‘æ’åˆ— */
                align-items: center;
                justify-content: space-between;
                /* å·¦å³æ’é–‹ */
                padding: 12px 15px;
                gap: 15px;
                border: 2px solid #555;
                /* å¼·èª¿é‚Šæ¡†ï¼Œå¦‚æœæœ‰éœ€è¦ */
            }

            .stats-left {
                flex-direction: row-reverse;
                /* é ­åƒåœ¨å·¦ï¼Œæœˆä»½åœ¨å³ */
                align-items: center;
                gap: 12px;
                border: none;
                padding: 0;
                margin: 0;
            }

            .avatar {
                font-size: 2.8rem;
                margin: 0;
                animation: none;
                /* æ‰‹æ©Ÿç‰ˆä¸æµ®å‹•ï¼Œé¿å…å¹²æ“¾ */
            }

            .turn-label {
                font-size: 1.2rem;
                white-space: nowrap;
            }

            .stats-right {
                gap: 6px;
                width: auto;
                min-width: 160px;
                /* ç¢ºä¿å³å´æœ‰ç©ºé–“ */
                flex: 1;
                /* è®“å³å´å¡«æ»¿å‰©é¤˜ç©ºé–“ */
            }

            .stat-row {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                gap: 8px;
                font-size: 0.9rem;
            }

            /* ç‰¹æ®Šä½ˆå±€ï¼šåç¨±+æ•¸å€¼+é€²åº¦æ¢ */
            .stat-meta {
                justify-content: flex-start;
                gap: 5px;
                width: auto;
            }

            .progress-bg {
                flex: 1;
                /* é€²åº¦æ¢è‡ªå‹•å¡«æ»¿å‰©é¤˜ç©ºé–“ */
                height: 6px;
                /* è®Šç´° */
                background: #333;
                width: auto;
            }

            .money-val {
                font-size: 1.1rem;
                margin-left: auto;
                /* é å³ */
            }

            /* éš±è—ä¸éœ€è¦çš„å…ƒç´  */
            .stat-row.cost-row {
                display: none;
            }

            /* 2. ä¸­é–“ï¼šä¸»æ§å° */
            .main-panel {
                flex: 1;
                min-height: 0;
                display: flex;
                flex-direction: column;
                gap: 10px;
            }

            .log-area {
                flex: 1;
                overflow-y: auto;
                padding: 15px;
                font-size: 0.95rem;
                margin: 0;
            }

            .ap-container {
                flex-shrink: 0;
                margin: 5px 0;
            }

            .action-area {
                flex-shrink: 0;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            button {
                padding: 15px;
            }

            /* 3. åº•éƒ¨ï¼šç‹€æ…‹æ¬„ */
            .status-panel {
                flex-shrink: 0;
                max-height: 120px;
                padding: 10px;
                overflow-y: auto;
            }
        }

        /* çµç®—ç•«é¢ (Modal) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--panel-color);
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 2px solid var(--accent-color);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-title {
            font-size: 2rem;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .modal-desc {
            font-size: 1.1rem;
            color: #ddd;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .modal-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
        }

        .modal-stat-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .modal-stat-val {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-color);
        }
    </style>
</head>

<body>

    <div class="game-container">
        <div class="stats-panel">
            <div class="stats-left">
                <div class="avatar" id="avatar">ğŸ˜</div>
                <div class="turn-label">ç¬¬ <span id="turn-display">1</span> æœˆ</div>
            </div>

            <div class="stats-right">
                <!-- ç†æ™º -->
                <div class="stat-row">
                    <div class="stat-meta">
                        <span class="stat-name">ğŸ§  ç†æ™º</span>
                        <span class="stat-val" id="val-sanity">60</span>
                    </div>
                    <div class="progress-bg">
                        <div class="progress-fill" id="bar-sanity" style="width: 60%; background: var(--danger-color);">
                        </div>
                    </div>
                </div>

                <!-- é€£çµ -->
                <div class="stat-row">
                    <div class="stat-meta">
                        <span class="stat-name">ğŸ¤ é€£çµ</span>
                        <span class="stat-val" id="val-social">40</span>
                    </div>
                    <div class="progress-bg">
                        <div class="progress-fill" id="bar-social" style="width: 40%; background: var(--info-color);">
                        </div>
                    </div>
                </div>

                <!-- å­˜æ¬¾ -->
                <div class="stat-row">
                    <div class="stat-meta" style="width:100%">
                        <span class="stat-name">ğŸ’° å­˜æ¬¾</span>
                        <span class="money-val" id="val-money">$5000</span>
                    </div>
                </div>

                <div class="stat-row cost-row" style="margin-top:5px;">
                    <div style="font-size:0.8rem; color:#666; text-align:center;">
                        æ¯æœˆæˆæœ¬: -$2,500
                    </div>
                </div>
            </div>
        </div>

        <div class="main-panel">
            <div class="log-area" id="log-display">
                <div class="log-entry system">
                    æ­¡è¿ä¾†åˆ°ã€Šå¾®å…‰è¨ˆç•«ã€‹ã€‚<br>
                    æ¯å€‹æœˆä½ æœ‰ 3 å€‹è¡Œå‹•é»æ•¸ (AP)ã€‚<br>
                    è«‹è¬¹æ…åˆ†é…å·¥ä½œã€ç¤¾äº¤èˆ‡é†«ç™‚ï¼Œæ’éé€™ä¸€å¹´ã€‚
                </div>
            </div>

            <div class="ap-container" id="ap-dots">
                <div class="ap-dot active"></div>
                <div class="ap-dot active"></div>
                <div class="ap-dot active"></div>
            </div>

            <div class="action-area" id="action-buttons">
                <button onclick="performAction('work')">
                    <strong>ğŸ’¼ æ‰“å·¥å…¼è·</strong>
                    <span class="sub">+$800~1200 | -5 ç†æ™º</span>
                </button>
                <button id="btn-connect" onclick="performAction('connect')">
                    <strong>ğŸ’¬ ç¤¾äº¤è¯ç¹«</strong>
                    <span class="sub">+10 é€£çµ | +8 ç†æ™º</span>
                </button>
                <button id="btn-toxic" onclick="performAction('toxic_connect')"
                    style="display:none; border-color:var(--danger-color); color:var(--danger-color);">
                    <strong>â˜ ï¸ æ‰¾ä»¥å‰çš„æ¯’å‹</strong>
                    <span class="sub">ä¸èŠ±éŒ¢ | +15ç†æ™º +15é€£çµ | ä»£åƒ¹?</span>
                </button>
                <button id="btn-medical" onclick="performAction('medical')">
                    <strong>ğŸ¥ å¿ƒç†è«®å•†</strong>
                    <span class="sub">-$800 | +20 ç†æ™º | é™¤ç‹€æ…‹</span>
                </button>
                <button id="btn-meditate" onclick="performAction('meditate')"
                    style="display:none; border-color:var(--info-color); color:var(--info-color);">
                    <strong>ğŸ§˜ æ­£å¿µå†¥æƒ³</strong>
                    <span class="sub">å…è²» | æª¢å®šï¼šç„¦æ…®/æˆ’æ–·/ç–¼ç—› | +10 ç†æ™º</span>
                </button>
                <button onclick="performAction('hide')">
                    <strong>ğŸ  ä¼‘æ¯ç¨è™•</strong>
                    <span class="sub">+5 ç†æ™º | ç„¡èŠ±è²»</span>
                </button>


            </div>
        </div>

        <div class="status-panel">
            <div class="status-header">ç•¶å‰èº«å¿ƒç‹€æ…‹ (Status)</div>
            <div id="status-list"></div>
        </div>
    </div>

    <!-- çµç®—ç•«é¢ Modal -->
    <div id="game-over-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title" id="modal-title">éŠæˆ²çµæŸ</div>
            <div class="modal-desc" id="modal-desc">å…§å®¹èªªæ˜...</div>

            <div class="modal-stats">
                <div class="modal-stat-item">
                    <span>æœ€çµ‚ç†æ™º</span>
                    <span class="modal-stat-val" id="end-sanity">0</span>
                </div>
                <div class="modal-stat-item">
                    <span>æœ€çµ‚å­˜æ¬¾</span>
                    <span class="modal-stat-val" id="end-money">0</span>
                </div>
                <div class="modal-stat-item">
                    <span>å­˜æ´»æœˆä»½</span>
                    <span class="modal-stat-val" id="end-turn">1</span>
                </div>
            </div>

            <button onclick="location.reload()" style="width:100%; background:var(--accent-color); color:#000;">
                <strong>ğŸ”„ é‡æ–°é–‹å§‹</strong>
            </button>
        </div>
    </div>

    <script>
        // --- 1. æ•¸æ“šåº« ---

        const effectDB = {
            'stigma': { name: 'è‡ªæˆ‘æ±¡å', type: 'debuff', desc: 'è¦ºå¾—ä½äººä¸€ç­‰ã€‚ç¤¾äº¤æ•ˆæœæ¸›åŠã€‚', onTurn: (lvl) => ({ sanity: -2 * lvl }) },
            'anxiety': { name: 'å»£æ³›æ€§ç„¦æ…®', type: 'debuff', desc: 'å°æœªä¾†çš„ææ‡¼ã€‚å·¥ä½œæ”¶å…¥ä¸ç©©ã€‚', onTurn: (lvl) => ({ sanity: -3 * lvl }) },
            'shame': { name: 'ç¾æ¥æ„Ÿ', type: 'debuff', desc: 'å…§åŒ–çš„ç½ªæƒ¡æ„Ÿã€‚', onTurn: (lvl) => ({ social: -2 * lvl }) },
            'numb': { name: 'æƒ…æ„Ÿéº»æœ¨', type: 'neutral', desc: 'é—œé–‰æ„ŸçŸ¥ã€‚ç¤¾äº¤ç„¡æ•ˆã€‚', onTurn: (lvl) => ({ social: -5 }) },
            'withdrawal': { name: 'æˆ’æ–·åæ‡‰', type: 'debuff', desc: 'èº«é«”åœ¨å°–å«ã€‚æ¥µåº¦å±éšªã€‚', onTurn: (lvl) => ({ sanity: -8 * lvl }) },
            'insomnia': { name: 'åš´é‡å¤±çœ ', type: 'debuff', desc: 'è—¥ç‰©å²é€ æˆçš„ç¡çœ éšœç¤™ã€‚', onTurn: (lvl) => ({ sanity: -4 }) },
            'pain': { name: 'æ…¢æ€§ç–¼ç—›', type: 'debuff', desc: 'èº«é«”ç–¼ç—›ã€‚', onTurn: (lvl) => ({ sanity: -2 }) },
            'suspicion': { name: 'è·å ´ç–‘æ…®', type: 'debuff', desc: 'ä¸»ç®¡è¦ºå¾—ä½ æ€ªæ€ªçš„ã€‚', onTurn: (lvl) => ({ money: -200 * lvl, sanity: -2 }) },
            'monitored': { name: 'é«˜å£“ç›£æ§', type: 'debuff', desc: 'å®¶äººç›¯å¾—å¾ˆç·Šã€‚', onTurn: (lvl) => ({ sanity: -3 }) },
            'trust': { name: 'ä¿¡ä»»é€£çµ', type: 'buff', desc: 'æœ‰äººé¡˜æ„ç›¸ä¿¡ä½ ã€‚', onTurn: (lvl) => ({ sanity: +2 * lvl }) },
            'stable_job': { name: 'ç©©å®šå°±æ¥­', type: 'buff', desc: 'å·¥ä½œå¸¶ä¾†æˆå°±æ„Ÿã€‚', onTurn: (lvl) => ({ money: +200, sanity: +1 }) },
            'imposter': { name: 'å†’ç‰Œè€…ç—‡å€™ç¾¤', type: 'debuff', desc: 'å®³æ€•è¢«è­˜ç ´èº«åˆ†ã€‚', onTurn: (lvl) => ({ sanity: -3 }) },
            'crash': { name: 'è—¥ç‰©åå™¬', type: 'debuff', desc: 'é æ”¯å¿«æ¨‚çš„ä»£åƒ¹ã€‚å¤šå·´èƒºæ°´å¹³æš´è·Œã€‚', onTurn: (lvl) => ({ sanity: -30 }) },
            'addiction_shadow': { name: 'æˆç™®é¢¨éšª', type: 'debuff', desc: 'æ¸´æœ›æ­£åœ¨ç´¯ç©ã€‚', onTurn: (lvl) => ({ sanity: -1 * lvl }) }
        };

        const eventsPool = [
            { text: "å…¬å¸èšé¤ç©ç¬‘ï¼šã€Œå¸æ¯’çš„äººéƒ½è©²æ­»åˆ‘ã€‚ã€", result: "ä½ åªèƒ½é™ªç¬‘ï¼Œå…§å¿ƒææ‡¼ã€‚", effect: () => { addEffect('imposter', 2, 1); changeStat('sanity', -5); } },
            { text: "HR è¦æ±‚è£œäº¤è‰¯æ°‘è­‰ã€‚", result: "ä½ ç·¨è—‰å£æ‹–å»¶ï¼Œç„¦æ…®å¤±çœ ã€‚", effect: () => { addEffect('anxiety', 3, 1); addEffect('insomnia', 2, 1); } },
            { text: "å®¶äººæ‡·ç–‘ä½ å¾©ç™¼ï¼ˆå› ç‚ºä½ å¸¸è·‘é†«é™¢ï¼‰ã€‚", result: "è¢«è¿«èªªè¬Šï¼Œä¿¡ä»»ç ´è£‚ã€‚", effect: () => { addEffect('monitored', 4, 1); changeStat('social', -10); } },
            { text: "æ·é‹é‡è‡¨æª¢ã€‚", result: "å‰µå‚·åæ‡‰è®“ä½ å…¨èº«åƒµç¡¬ã€‚", effect: () => { changeStat('sanity', -10); addEffect('shame', 2, 1); } },
            { text: "ç”¨è—¥å¤¢ (Using Dream)ï¼šå¤¢è¦‹ä»¥å‰çš„å¿«æ„Ÿã€‚", result: "é†’ä¾†å…¨æ˜¯å†·æ±—ï¼Œæ¸´æœ›å¼·çƒˆã€‚", effect: () => { addEffect('withdrawal', 1, 1); changeStat('sanity', -10); } },
            { text: "ç‰™é½¦è…«ç—›ç™¼ä½œã€‚", result: "èŠ±äº†ä¸€ç­†é†«è—¥è²»ã€‚", effect: () => { addEffect('pain', 2, 1); changeStat('money', -1000); } },
            { text: "è«åçš„ç©ºè™›ç„¡èŠã€‚", result: "å¥½æƒ³æ‰¾é»åˆºæ¿€ã€‚", effect: () => { changeStat('sanity', -5); } },
            { text: "è—¥é ­ç°¡è¨Šï¼šã€Œæœ‰æ–°è²¨ã€‚ã€", result: "æ‰‹æŒ‡åœ¨å°é–éµä¸Šé¡«æŠ–ã€‚", effect: () => { addEffect('withdrawal', 2, 1); changeStat('sanity', -15); } },
            { text: "åŒå­¸æœƒçš„ç¤¾æœƒæ¯”è¼ƒã€‚", result: "è¦ºå¾—è‡ªå·±äººç”Ÿæ¯€äº†ã€‚", effect: () => { addEffect('stigma', 3, 1); } },
            { text: "è§€è­·äººå ±åˆ°è¡å ‚ï¼Œè¢«è¿«è«‹å‡ã€‚", result: "ä¸»ç®¡è‡‰è‰²é›£çœ‹ã€‚", effect: () => { addEffect('suspicion', 2, 1); } },
            { text: "äº¤å‹è»Ÿé«”è¢«å•ï¼šã€Œç©ºç™½é‚£ä¸€å¹´å»å“ªäº†ï¼Ÿã€", result: "åš‡å¾—è§£é™¤é…å°ã€‚", effect: () => { changeStat('social', -5); addEffect('anxiety', 2, 1); } },
            { text: "é¤µäº†ä¸€éš»æµæµªè²“ã€‚", result: "å¿ƒæƒ…å¹³éœäº†è¨±å¤šã€‚", effect: () => { changeStat('sanity', +10); } },
            { text: "å€‹ç®¡å¸«æ‰“é›»è©±ä¾†é—œå¿ƒã€‚", result: "è¦ºå¾—ä¸æ˜¯å­¤è»å¥®æˆ°ã€‚", effect: () => { changeStat('sanity', +5); addEffect('trust', 1, 1); } },
            { text: "è€é—†ç™¼äº†ä¸€é»å°çé‡‘ã€‚", result: "è¢«è‚¯å®šçš„æ„Ÿè¦ºã€‚", effect: () => { changeStat('money', +1000); addEffect('stable_job', 3, 1); removeEffect('suspicion'); } },
            { text: "åƒåŠ äº’åŠ©æœƒ (NA)ã€‚", result: "ç™¼ç¾è‡ªå·±ä¸å­¤å–®ã€‚", effect: () => { removeEffect('shame'); changeStat('sanity', +15); } },
            { text: "æˆ¿æ±æ¼²ç§Ÿã€‚", result: "ç”Ÿå­˜å£“åŠ›å€å¢ã€‚", effect: () => { changeStat('money', -1500); changeStat('sanity', -5); } },
            { text: "å¡å‚µå¼·åˆ¶æ‰£è–ªã€‚", result: "çµ•æœ›æ„Ÿã€‚", effect: () => { changeStat('money', -2000); addEffect('anxiety', 2, 1); } },
            { text: "æ©Ÿè»Šå£äº†ã€‚", result: "ç¶­ä¿®è²»è®“ä½ èµ¤å­—ã€‚", effect: () => { changeStat('money', -1000); } },
            { text: "æ”¶åˆ°æ³•é™¢è­‰äººå‚³ç¥¨ã€‚", result: "è™›é©šä¸€å ´ä½†å¾ˆç´¯ã€‚", effect: () => { changeStat('sanity', -5); } },
            { text: "é‡è¦‹å‹å–„ç¤¾å·¥ã€‚", result: "ä¸–ç•Œé‚„æ˜¯æœ‰æº«åº¦çš„ã€‚", effect: () => { changeStat('sanity', +10); changeStat('social', +5); } }
        ];

        // --- 2. éŠæˆ²é‚è¼¯ ---

        let gameState = {
            turn: 1,
            maxTurns: 12,
            sanity: 60,
            social: 40,
            money: 5000,
            ap: 3,         // ç•¶å‰ AP
            maxAp: 3,      // æœ€å¤§ AP
            costOfLiving: 2500, // æ¯æœˆå›ºå®šæ”¯å‡º (å·²ä¸‹èª¿)
            activeEffects: [],
            addictionRisk: 0 // æˆç™®/çŠ¯ç½ªå€¼ (éš±è—æ•¸å€¼)
        };

        // åˆå§‹åŒ–
        addEffect('imposter', 12, 1);
        updateUI();

        function changeStat(type, val) {
            gameState[type] += val;
            if (type === 'sanity') gameState.sanity = Math.min(100, gameState.sanity);
            if (type === 'social') gameState.social = Math.min(100, Math.max(0, gameState.social));
        }

        function addEffect(id, dur, lvl = 1) {
            let existing = gameState.activeEffects.find(e => e.id === id);
            if (existing) {
                existing.duration = Math.max(existing.duration, dur);
                existing.level += lvl;
            } else {
                gameState.activeEffects.push({ id: id, duration: dur, level: lvl });
            }
            updateStatusList();
        }

        function removeEffect(id) {
            gameState.activeEffects = gameState.activeEffects.filter(e => e.id !== id);
            updateStatusList();
        }

        function hasEffect(id) { return gameState.activeEffects.some(e => e.id === id); }

        // --- è¡Œå‹•ç³»çµ± ---

        function performAction(type) {
            if (gameState.ap <= 0) return;

            let logText = "";
            let risk = Math.random();

            // æ‰£é™¤ AP
            gameState.ap--;

            if (type === 'work') {
                // å¹³è¡¡èª¿æ•´ï¼šå·¥ä½œæ”¶å…¥ $800-1200ï¼Œæ‰£ç†æ™º 5-8
                let income = 800 + Math.floor(Math.random() * 400);
                let sanityCost = 5 + Math.floor(Math.random() * 3);

                // ç‹€æ…‹å½±éŸ¿
                if (hasEffect('suspicion')) { income -= 200; sanityCost += 2; }
                if (hasEffect('anxiety')) { sanityCost += 2; }
                if (hasEffect('stable_job')) { income += 200; sanityCost -= 2; }

                if (risk < 0.1) { // 10% æ©Ÿç‡æç ¸
                    logText = "å·¥ä½œæç¥çŠ¯éŒ¯ï¼Œè¢«ä¸»ç®¡ç½µäº†ã€‚";
                    changeStat('sanity', -10);
                    addEffect('suspicion', 2, 1);
                    changeStat('money', income);
                } else {
                    logText = `æ‰“å·¥çµæŸï¼Œè³ºäº† $${income}ã€‚`;
                    changeStat('sanity', -sanityCost);
                    changeStat('money', income);
                    if (risk > 0.9) addEffect('stable_job', 2, 1);
                }
            }
            else if (type === 'connect') {
                // è²§çª®éš”é›¢æ©Ÿåˆ¶ï¼šé›–ç„¶å‰ç«¯éš±è—äº†æŒ‰éˆ•ï¼Œä½†å¾Œç«¯ä¹Ÿåšå€‹é˜²å‘†
                if (gameState.money < 500) {
                    addLog("ä½ å£è¢‹ç©ºç©ºï¼Œæ²’è‡‰è¦‹æœ‹å‹ã€‚(å­˜æ¬¾ < $500)", "danger");
                    gameState.ap++;
                    return;
                }

                // ç¤¾äº¤ä¸èŠ±éŒ¢ï¼Œå›ç†æ™ºï¼Œå›é€£çµ
                if (hasEffect('stigma') || hasEffect('shame')) {
                    if (risk < 0.5) {
                        logText = "è©¦åœ–è¯ç¹«æœ‹å‹ï¼Œä½†è¦ºå¾—è‡ªå·±ä¸é…ï¼Œåˆæ›æ–·äº†ã€‚";
                        changeStat('sanity', -2);
                        changeStat('social', -2); // æŒ«æŠ˜æ„Ÿæ‰£é€£çµ
                    } else {
                        logText = "é›–ç„¶å°·å°¬ï¼Œä½†é‚„æ˜¯å’Œå®¶äººåƒäº†é£¯ã€‚";
                        changeStat('social', +8);
                        changeStat('sanity', +2);
                    }
                } else {
                    logText = "å’Œæœ‹å‹èŠå¤©ï¼Œå¿ƒæƒ…æ”¾é¬†ã€‚";
                    changeStat('sanity', +8);
                    changeStat('social', +10);
                    addEffect('trust', 2, 1);
                }
            }
            else if (type === 'toxic_connect') {
                // æ¯’åœˆçš„èª˜æƒ‘ï¼šé æ”¯å¿«æ¨‚ (Happy Loan)
                logText = "ã€æ‰¾ä»¥å‰çš„æ¯’å‹ã€‘ä½ åä¸‹äº†å®ƒã€‚ä¸–ç•Œç¬é–“è®Šå¾—é®®è±”ã€æº«æš–ä¸”å……æ»¿æ„›ã€‚";

                // ç«‹å³å›å ±
                changeStat('sanity', +15);
                changeStat('social', +15);

                // å¢åŠ æˆç™®å€¼
                gameState.addictionRisk += 15;

                // 1. æ–½åŠ åå™¬æ•ˆæœ (ä¸‹å›åˆæ‰£ 30 ç†æ™º)
                addEffect('crash', 1, 1);

                // 2. æ›´æ–°æˆç™®æ¨™ç±¤ (è¦–è¦ºåŒ–é¢¨éšª)
                // é€™è£¡æˆ‘å€‘ç”¨ addiction_shadow ä¾†é¡¯ç¤ºç›®å‰çš„é¢¨éšªç­‰ç´š (æ¯ 15 é»é¢¨éšª = 1 Lv)
                let currentRiskLvl = Math.floor(gameState.addictionRisk / 15);
                // ç§»é™¤èˆŠçš„ä¸¦é‡æ–°åŠ å…¥ä»¥æ›´æ–°ç­‰ç´š
                if (hasEffect('addiction_shadow')) removeEffect('addiction_shadow');
                addEffect('addiction_shadow', 99, currentRiskLvl);

                addLog("è­¦å‘Šï¼šä½ é æ”¯äº†æœªä¾†çš„å¿«æ¨‚ï¼Œä»£åƒ¹å³å°‡åˆ°ä¾†ã€‚", "danger");
            }
            else if (type === 'medical') {
                // é†«ç™‚èŠ±è²» $800 (ä¸‹èª¿)ï¼Œå›ç†æ™º +20
                if (gameState.money < 800) {
                    addLog("å­˜æ¬¾ä¸è¶³ ($800)ï¼Œç„¡æ³•æ”¯ä»˜æ›è™Ÿè²»ã€‚", "danger");
                    gameState.ap++; // é€€å› AP
                    return;
                }
                changeStat('money', -800);
                changeStat('sanity', +20);

                removeEffect('withdrawal');
                removeEffect('insomnia');
                if (hasEffect('anxiety')) removeEffect('anxiety');
                logText = "é€²è¡Œäº†å¿ƒç†è«®å•†èˆ‡è—¥ç‰©èª¿æ•´ã€‚ç„¦æ…®æ„Ÿæ¸›è¼•äº†ã€‚";
            }
            else if (type === 'meditate') {
                // å†¥æƒ³ï¼šå…è²»ï¼Œä½†å—ç‹€æ…‹å½±éŸ¿ (Check Mechanic)
                // æª¢æŸ¥å¹²æ“¾ç‹€æ…‹
                let debuffs = ['anxiety', 'withdrawal', 'pain'];
                let interfereCount = 0;
                let interfereNames = [];

                debuffs.forEach(d => {
                    if (hasEffect(d)) {
                        interfereCount++;
                        interfereNames.push(effectDB[d].name);
                    }
                });

                // æˆåŠŸç‡è¨ˆç®—: åŸºç¤ 80% - æ¯å€‹å¹²æ“¾ -30%
                // ä¹Ÿå°±æ˜¯ï¼š1å€‹å¹²æ“¾=50%, 2å€‹=20%, 3å€‹=0%
                let successChance = 0.8 - (interfereCount * 0.3);

                if (Math.random() < successChance) {
                    logText = "ä½ é–‰ä¸Šçœ¼ç›ï¼Œæ„Ÿå—å‘¼å¸ã€‚ç´›äº‚çš„é›œå¿µé€æ¼¸æ²‰æ¾±ï¼Œå…§å¿ƒæ‰¾å›äº†å¹³éœã€‚";
                    changeStat('sanity', +10);
                } else {
                    logText = `ä½ è©¦åœ–å†¥æƒ³ï¼Œä½†${interfereNames.join('èˆ‡')}å¸¶ä¾†çš„ç—›è‹¦ä¸æ–·ä¾µè•ä½ çš„å°ˆæ³¨åŠ›ã€‚`;
                    changeStat('sanity', -5); // å¤±æ•—åè€Œå—æŒ«
                    addLog("å†¥æƒ³æª¢å®šå¤±æ•—ï¼šé›œå¿µå…¥ä¾µã€‚", "danger");
                }
            }
            else if (type === 'hide') {
                // ä¼‘æ¯å›ç†æ™º +5ï¼Œç„¡èŠ±è²»
                changeStat('sanity', +5);
                addEffect('numb', 2, 1);
                logText = "æŠŠè‡ªå·±é—œåœ¨æˆ¿é–“ä¼‘æ¯ï¼Œæš«æ™‚é€ƒé¿ä¸–ç•Œã€‚";
            }

            addLog(logText);

            if (gameState.ap <= 0) {
                // è‡ªå‹•çµç®—
                endMonth();
            } else {
                updateUI();
            }
        }

        // --- æœˆçµç®—ç³»çµ± ---

        function endMonth() {
            addLog(`--- ç¬¬ ${gameState.turn} æœˆ çµç®— ---`, "system");

            // 1. æ‰£ç”Ÿæ´»è²»
            changeStat('money', -gameState.costOfLiving);
            addLog(`æ”¯ä»˜æœ¬æœˆç”Ÿæ´»è²»èˆ‡æˆ¿ç§Ÿ -$${gameState.costOfLiving}ã€‚`);

            // 1.5 é€£çµè¡°é€€ (Social Decay) - æ²™æ¼æ©Ÿåˆ¶
            changeStat('social', -5);
            addLog(`é•·ä¹…æœªè¯ç¹«ï¼Œç¤¾æœƒé€£çµè‡ªç„¶è¡°é€€äº† (-5)ã€‚`, "system");

            // 2. ç‹€æ…‹æ•ˆæœçµç®—
            processTurnEffects();

            // 3. éš¨æ©Ÿäº‹ä»¶ (40% æ©Ÿç‡)
            if (gameState.sanity > 0 && Math.random() < 0.4) {
                triggerRandomEvent();
            }

            // 4. æº–å‚™ä¸‹å€‹æœˆ
            gameState.turn++;
            gameState.ap = gameState.maxAp; // é‡ç½® AP

            checkGameOver();
            updateUI();
        }

        function processTurnEffects() {
            gameState.activeEffects.forEach(e => {
                let db = effectDB[e.id];
                let diff = db.onTurn(e.level);
                if (diff.sanity) changeStat('sanity', diff.sanity);
                if (diff.social) changeStat('social', diff.social);
                if (diff.money) changeStat('money', diff.money);
                e.duration--;
            });
            gameState.activeEffects = gameState.activeEffects.filter(e => e.duration > 0);
        }

        function triggerRandomEvent() {
            let evt = eventsPool[Math.floor(Math.random() * eventsPool.length)];
            addLog(evt.text, "event");
            addLog(`çµæœï¼š${evt.result}`, "danger");
            evt.effect();
        }

        function updateUI() {
            document.getElementById('turn-display').innerText = gameState.turn;
            document.getElementById('val-sanity').innerText = Math.floor(gameState.sanity);
            document.getElementById('bar-sanity').style.width = Math.max(0, gameState.sanity) + "%";
            document.getElementById('val-social').innerText = Math.floor(gameState.social);
            document.getElementById('bar-social').style.width = Math.max(0, gameState.social) + "%";

            let moneyEl = document.getElementById('val-money');
            moneyEl.innerText = `$${gameState.money}`;
            moneyEl.style.color = gameState.money < 0 ? 'red' : 'var(--warning-color)';

            // AP é»æ•¸è¦–è¦ºåŒ–
            const apDots = document.querySelectorAll('.ap-dot');
            apDots.forEach((dot, idx) => {
                dot.classList.toggle('active', idx < gameState.ap);
            });

            // æŒ‰éˆ•ç‹€æ…‹æ§åˆ¶ & è²§çª®éš”é›¢æ©Ÿåˆ¶
            const allBtns = document.querySelectorAll('#action-buttons button');
            const btnConnect = document.getElementById('btn-connect');
            const btnToxic = document.getElementById('btn-toxic');

            if (gameState.ap <= 0) {
                allBtns.forEach(b => b.disabled = true);
            } else {
                allBtns.forEach(b => b.disabled = false);

                // è²§çª®éš”é›¢ + æ¯’åœˆèª˜æƒ‘ logic
                // ä¿®æ”¹ï¼šç”±ã€Œå­˜æ¬¾ < 500ã€æ”¹ç‚ºã€Œç¤¾æœƒé€£çµ < 10ã€
                if (gameState.social < 10) {
                    btnConnect.style.display = 'none';
                    btnToxic.style.display = 'block';
                } else {
                    btnConnect.style.display = 'block';
                    btnToxic.style.display = 'none';
                }

                // å¿ƒç†è«®å•† vs å†¥æƒ³åˆ‡æ› (å­˜æ¬¾ < $800 æ™‚)
                const btnMedical = document.getElementById('btn-medical');
                const btnMeditate = document.getElementById('btn-meditate');

                if (gameState.money < 800) {
                    btnMedical.style.display = 'none';
                    btnMeditate.style.display = 'block';
                } else {
                    btnMedical.style.display = 'block';
                    btnMeditate.style.display = 'none';
                }
            }

            // é ­åƒ
            let av = document.getElementById('avatar');
            if (gameState.sanity > 80) av.innerText = "ğŸ™‚";
            else if (gameState.sanity > 50) av.innerText = "ğŸ˜";
            else if (gameState.sanity > 20) av.innerText = "ğŸ˜°";
            else av.innerText = "ğŸ§Ÿ";

            updateStatusList();
        }

        function updateStatusList() {
            let container = document.getElementById('status-list');
            container.innerHTML = "";
            if (gameState.activeEffects.length === 0) {
                container.innerHTML = "<div style='color:#666; font-style:italic;'>ç„¡ç‰¹æ®Šç‹€æ…‹</div>";
                return;
            }
            gameState.activeEffects.forEach(e => {
                let db = effectDB[e.id];
                let el = document.createElement('div');
                el.className = `status-item ${db.type}`;
                el.onclick = function () { this.classList.toggle('expanded'); };
                el.innerHTML = `
                    <div class="status-top">
                        <span class="status-name">${db.name} ${e.level > 1 ? 'Lv' + e.level : ''}</span>
                        <span class="status-dur">${e.duration}æœˆ</span>
                    </div>
                    <div class="status-desc">${db.desc}</div>
                `;
                container.appendChild(el);
            });
        }

        function addLog(text, type = "normal") {
            let div = document.createElement('div');
            div.className = `log-entry ${type}`;
            div.innerText = text;
            let area = document.getElementById('log-display');
            area.prepend(div);
        }

        function checkGameOver() {
            let isGameOver = false;
            let title = "";
            let desc = "";
            let type = "bad"; // bad or good

            // æ¢ä»¶ 1: ç†æ™ºæ­¸é›¶
            if (gameState.sanity <= 0) {
                // --- æ–°å¢ï¼šå¾©æ´»ç”²æ©Ÿåˆ¶ (Second Chance) ---
                if (gameState.social > 60) {
                    gameState.sanity = 25; // æ•‘å›ä¾†ä¸€é»
                    gameState.social = 0;  // äººæƒ…ç”¨å…‰

                    addLog("ã€ç€•æ­»æ•‘æ´ã€‘åœ¨ä½ å¤±å»æ„è­˜å‰ï¼Œä½ çš„æ±‚æ•‘è¨Šè™Ÿè¢«è½è¦‹äº†ã€‚", "success");
                    addLog("æœ‹å‹ç™¼ç¾ä½ å€’åœ¨å®¶è£¡ï¼Œå¼·åˆ¶é€é†«ã€‚å…é™¤äº†æ­»äº¡ï¼Œä½†ä½ å€‘çš„é—œä¿‚å¾¹åº•é€æ”¯äº† (é€£çµæ­¸é›¶)ã€‚", "event");

                    // å› ç‹€æ…‹æ”¹è®Šï¼Œéœ€ç«‹å³æ›´æ–° UI æ•¸å€¼é¡¯ç¤ºï¼Œé¿å…è¦–è¦ºè½å·®
                    document.getElementById('val-sanity').innerText = Math.floor(gameState.sanity);
                    document.getElementById('bar-sanity').style.width = Math.max(0, gameState.sanity) + "%";
                    document.getElementById('val-social').innerText = "0";
                    document.getElementById('bar-social').style.width = "0%";

                    return; // é˜»æ­¢éŠæˆ²çµæŸ
                }
                // -------------------------------------

                isGameOver = true;
                title = "ã€Bad Endã€‘ç†æ™ºå´©æ½°";
                desc = "ä½ çš„ç²¾ç¥å†ä¹Ÿç„¡æ³•æ‰¿å—ç¾å¯¦çš„é‡å£“ã€‚åœ¨ç„¡åŠ©èˆ‡ç—›è‹¦ä¸­ï¼Œä½ é¸æ“‡äº†æœ€å±éšªçš„é€ƒé¿æ–¹å¼â€”â€”å¾©ç™¼ ODã€‚<br><br>é€™ä¸€æ¬¡ï¼Œæˆ–è¨±çœŸçš„å›ä¸ä¾†äº†ã€‚";
                type = "bad";
            }
            // æ¢ä»¶ 1.5: æˆç™®å€¼éé«˜ (éš±è—çµå±€)
            else if (gameState.addictionRisk >= 100) {
                isGameOver = true;
                title = "ã€Bad Endã€‘ç„¡æ³•å›é ­çš„æ·±æ·µ";
                desc = "ä½ ä»¥ç‚ºä½ åªæ˜¯å»æ•˜èˆŠï¼Œä½†æ¯’å“çš„å¼•åŠ›æ¯”ä½ æƒ³åƒå¾—æ›´å¤§ã€‚<br><br>ä¸€é–‹å§‹åªæ˜¯ã€Œä¸€å£å°±å¥½ã€ï¼Œæœ€å¾Œä½ ç™¼ç¾è‡ªå·±åˆå›åˆ°äº†é‚£å€‹é™°æš—çš„æˆ¿é–“ï¼Œè€Œé€™ä¸€æ¬¡ï¼Œå†ä¹Ÿæ²’æœ‰äººèƒ½æ‹‰ä½ ä¸€æŠŠã€‚";
                type = "bad";
            }
            // æ¢ä»¶ 2: è³‡é‡‘ <= -5000 (ç ´ç”¢)
            else if (gameState.money <= -5000) {
                isGameOver = true;
                title = "ã€Bad Endã€‘ç¤¾æœƒæ€§æ­»äº¡";
                desc = "å‚µå‹™å¦‚é›ªçƒèˆ¬è¶Šæ»¾è¶Šå¤§ã€‚æˆ¿æ±å°‡ä½ è¶•å‡ºé–€ï¼ŒéŠ€è¡Œå‡çµäº†å¸³æˆ¶ï¼Œä½ è¢«è¿«æµè½è¡—é ­ã€‚<br><br>åœ¨é€™ç¨®æ¥µç«¯ç’°å¢ƒä¸‹ï¼Œå¾©æ­¸ç¤¾æœƒæˆäº†ä¸€å ´é†’ä¸éä¾†çš„å¤¢ã€‚";
                type = "bad";
            }
            // æ¢ä»¶ 3: æ’é 12 å€‹æœˆ
            else if (gameState.turn > gameState.maxTurns) {
                isGameOver = true;
                title = "ã€Good Endã€‘å¾®å…‰ä¸­çš„é»æ˜";
                desc = "ä¸€å¹´éå»äº†ã€‚é›–ç„¶ç”Ÿæ´»ä¾ç„¶å……æ»¿æŒ‘æˆ°ï¼Œå‚·å£ä¹Ÿå¶çˆ¾æœƒéš±éš±ä½œç—›ï¼Œä½†ä½ æ´»ä¸‹ä¾†äº†ã€‚<br><br>ä½ æ‰¾å›äº†ä¸€é»å°æœªä¾†çš„æŒæ§æ„Ÿã€‚é€™å°±æ˜¯å¾©æ­¸æ—…ç¨‹çš„ç¬¬ä¸€æ­¥ã€‚";
                type = "good";
            }

            if (isGameOver) {
                document.getElementById('modal-title').innerText = title;
                document.getElementById('modal-desc').innerHTML = desc;

                // è¨­å®šé¡è‰²
                let titleEl = document.getElementById('modal-title');
                if (type === 'good') titleEl.style.color = 'var(--accent-color)';
                else titleEl.style.color = 'var(--danger-color)';

                document.getElementById('end-sanity').innerText = Math.floor(gameState.sanity);
                document.getElementById('end-money').innerText = "$" + gameState.money;
                document.getElementById('end-turn').innerText = Math.min(gameState.turn, 12); // é˜²æ­¢é¡¯ç¤º 13 æœˆ

                document.getElementById('game-over-modal').style.display = "flex";
            }
        }

        // ä¿®æ”¹ updateUI ä»¥åŒ…å«éŠæˆ²çµæŸæª¢æŸ¥
        const _originalUpdateUI = updateUI;
        updateUI = function () {
            _originalUpdateUI();
            checkGameOver();
        };
    </script>
</body>

</html>